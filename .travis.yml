language: c
compiler:
- clang
- gcc
sudo: false
cache: ccache
script:
- tests/scripts/recursion.pl library/*.c
- tests/scripts/check-generated-files.sh
- tests/scripts/check-doxy-blocks.pl
- tests/scripts/check-names.sh
- tests/scripts/check-files.py
- tests/scripts/doxygen.sh
- cmake -D CMAKE_BUILD_TYPE:String="Check" .
- make
- make test
- programs/test/selftest
- OSSL_NO_DTLS=1 tests/compat.sh
- tests/ssl-opt.sh -e '\(DTLS\|SCSV\).*openssl'
- tests/scripts/test-ref-configs.pl
- tests/scripts/curves.pl
- tests/scripts/key-exchanges.pl
after_failure:
- tests/scripts/travis-log-failure.sh
env:
  global:
   # The next declaration is the encrypted COVERITY_SCAN_TOKEN, created
   #   via the "travis encrypt" command using the project repo's public key
   - secure: "XvFO8JkRFB8MedxULfdX17dLkDmPALPXJrrSQLdiin/u0XPple9nbgkRBA6x56wAB4dIVocP9zwaW7SLTF/4qSYFaBbJK3kysgaxGcro2UdhvogHYC91hxdplQfSqMioP6+uSHhWpJFFyX/PWiIXhIlyw6JoYe3A6KIT5shd90t93bcCX1mr9AqYfeNadJF/stLZQap8AnslmZchLUXCWEUV/tTe1jq1bQYju6UqS0c6wlq/NmbCcE7U88NysD8Lg3NLL/z+X6biKa9BTMMZEV//3YbNbJ0ftBsHSdmkxgVB3s8fLQQnPQhJDGmfAixE6jitKYKIhOqHxbVJRPzx9v4jm6qnNO3XitLA+wBL4krGzc+ConPOB1wmBLxAd/SPwIsIaQL6unXLcQQbr4V1c3Tafs9RXZKiJSyhj5TPF49f2elASVFYySm9/Vz/Po0BYvXDChUj2Vo76aw4IHZyHaK4DZtytgQuFvwCgt6DMT7xrAMCe6haxP1vacKRh1D4geiGwoq6hVLv9VTYe2Wl9/cvMb7xnDiI9HLPH45IVrM93Ja9t6yM4m8LBPeZNe+dSHRx5QWftRHYXVQhQ3TRlztsUw8D9Pz9dyWed1T2naleIneWDGcsYCOYgYHozd/RfOuvarQw2UBzAVH3c/tV5qkSo0rS7FhKyrRL/CLn4xU="

addons:
  apt:
    packages:
    - doxygen
    - graphviz
  coverity_scan:
    project:
      name: "ARMmbed/mbedtls"
    notification_email: simon.butcher@arm.com
    build_command_prepend:
    build_command: make
    branch_pattern: coverity_scan
